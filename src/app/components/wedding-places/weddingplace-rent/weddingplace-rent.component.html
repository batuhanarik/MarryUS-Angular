<div *ngIf="!confirmed && !selectedDate" class="grid">
  <div class="col-span-6">
    <div class="text-center"><b>Tarih Seçiniz.</b></div>
    <div *ngIf="occupiedDatesLoaded" class="flex justify-center">
      <p-calendar
        class="ml-2"
        (onSelect)="rentDaySelect($event)"
        [(ngModel)]="rentDate"
        [showOtherMonths]="true"
        [disabled]="confirmed"
        [readonlyInput]="true"
        [inline]="true"
        inputId="rentDate"
        [minDate]="today"
        [maxDate]="maxDate"
        [disabledDates]="occupiedDates"
      ></p-calendar>
    </div>
    <div class="flex justify-end">
      <button
        pButton
        type="button"
        label="Next"
        class="p-button-outlined p-button-rounded"
        (click)="next()"
      ></button>
    </div>
  </div>
</div>

<div *ngIf="confirmed" class="items-end-end">
  <div class="row text-center">
    <a>{{ "1 gecelik kiralama fiyatı :" + totalRentPrice + "TL" }}</a>
  </div>
  <form [formGroup]="creditCardForm">
    <div class="p-fluid formgrid grid">
      <div class="col-span-12 flex flex-col">
        <label id="name" for="cardHolderName">Kart Sahibinin Adı</label>
        <input
          type="text"
          placeholder="Batuhan ARIK"
          formControlName="cardHolderName"
          class="input input-bordered input-primary w-full block"
        />
      </div>
      <div class="flex flex-row">
        <div class="col-span-8">
          <label id="number" for="cardNumber">Kart Numarası</label>
          <p-inputMask
            formControlName="cardNumber"
            inputId="number"
            mask="9999-9999-9999-9999"
          ></p-inputMask>
        </div>
        <div class="flex flex-row">
          <div class="col-span-2">
            <label id="date" for="date">Tarih</label>
            <p-inputMask
              inputId="date"
              mask="99/99"
              formControlName="date"
            ></p-inputMask>
          </div>
          <div class="col-span-2">
            <label for="cvc">CVC</label>
            <p-inputMask
              inputId="cvc"
              mask="999"
              formControlName="cvc"
            ></p-inputMask>
          </div>
        </div>
      </div>
    </div>
  </form>
  <div class="flex justify-between mt-5">
    <div class="col-auto">
      <button
        pButton
        type="button"
        label="Back"
        class="p-button-outlined p-button-rounded"
        (click)="back()"
      ></button>
    </div>

    <div class="col-auto">
      <button
        [disabled]="creditCardForm.invalid"
        pButton
        type="button"
        label="Confirm"
        class="p-button-outlined p-button-rounded"
        (click)="confirm()"
      ></button>
    </div>
  </div>
</div>

<div *ngIf="selectedDate">
  <h2>Tercihlerinizi belirtir misiniz?</h2>
  <div class="flex flex-row col-span-12">
    <div class="sm:col-span-6">
      <div class="w-full">
        <!-- Alkol Var Mı -->
        <div class="form-control !flex-row">
          <label class="label cursor-pointer">
            <input
              [disabled]="!config.data.isAlcoholIncluded"
              [(ngModel)]="isAlcoholIncluded"
              type="checkbox"
              class="checkbox"
            />
            <span
              class="label-text mx-3"
              [ngClass]="!config.data.isAlcoholIncluded ? 'line-through' : ''"
              >Düğün yerinde alkol hizmeti var mı?</span
            >
          </label>
        </div>
        <!-- Yemek Var Mı -->
        <div class="form-control !flex-row">
          <label class="label cursor-pointer">
            <input
              [disabled]="!config.data.isFoodIncluded"
              type="checkbox"
              class="checkbox"
              [(ngModel)]="isFoodIncluded"
            />
            <span
              class="label-text mx-3"
              [ngClass]="!config.data.isFoodIncluded ? 'line-through' : ''"
              >Düğün yerinde yemek hizmeti var mı?</span
            >
          </label>
        </div>
        <!-- Kokteyl Var Mı -->
        <div class="form-control !flex-row">
          <label class="label cursor-pointer">
            <input
              [disabled]="!config.data.isCocktailIncluded"
              [(ngModel)]="isCocktailIncluded"
              type="checkbox"
              class="checkbox"
            />
            <span
              class="label-text mx-3"
              [ngClass]="!config.data.isCocktailIncluded ? 'line-through' : ''"
              >Düğün yerindeki kokteyl var mı?</span
            >
          </label>
        </div>
      </div>
    </div>
  </div>
  <div class="flex flex-row justify-between">
    <div class="flex justify-end items-center">
      <div class="sm:col-span-3">
        <div class="form-control">
          <label class="label">
            <span class="label-text font-semibold"
              >Düğün kapasitesi {{ config.data.capacityFirst }} -
              {{ config.data.capacityLast }} Aralığında olmalıdır.</span
            >
          </label>
          <label class="input-group">
            <input
              type="number"
              [(ngModel)]="selectedCapacity"
              [min]="config.data.capacityFirst"
              [max]="config.data.capacityLast"
              step="10"
              class="input input-bordered"
            />
            <span>Kişi</span>
          </label>
        </div>
      </div>
    </div>
    <div class="flex justify-end items-center">
      <div class="avatar placeholder w-23 font-medium text-black">
        <div class="bg-neutral-focus text-neutral-content rounded-full w-24">
          <span class="text-xl">{{
            weddingPlacePrice * selectedCapacity +
              (isFoodIncluded ? config.data.priceFood * selectedCapacity : 0) +
              (isAlcoholIncluded
                ? config.data.priceAlcohol * selectedCapacity
                : 0) +
              (isCocktailIncluded
                ? config.data.priceCocktail * selectedCapacity
                : 0)
          }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
